const { Sequelize: { Model } } = require( 'sequelize' );
const { User: UserSchema } = require( '../schema' );

class User extends Model {}

module.exports = sequelize => {

    User.init( UserSchema, { sequelize, tableName: 'users', underscored: true, timestamps: true } );
    User.associate = models => {

        User.hasMany( models.Order, { foreignKey: 'userId' } );
        User.hasMany( models.PurchasedGiftcard, { foreignKey: 'userId' } );
        User.belongsToMany( models.OnlineMerchant, { through: 'user_online_merchants' } );
        User.hasMany( models.UserOnlineOffer, { foreignKey: 'userId' } );
        User.belongsToMany( models.Giftcard, { through: 'user_giftcards' } );
        User.hasMany( models.UserSaving, { foreignKey: 'userId' } );

    };

    return User;

};
