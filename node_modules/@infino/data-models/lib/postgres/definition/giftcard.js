const { Sequelize: { Model } } = require( 'sequelize' );
const sequelizePaginate = require( 'sequelize-paginate' );
const { Giftcard: GiftcardSchema } = require( '../schema' );

class Giftcard extends Model {}

module.exports = sequelize => {

    Giftcard.init( GiftcardSchema, { sequelize, tableName: 'giftcards', underscored: true, timestamps: true } );
    Giftcard.associate = models => {

        Giftcard.belongsTo( models.Provider, { foreignKey: 'providerId' } );
        Giftcard.belongsTo( models.OnlineMerchant, { foreignKey: 'merchantId' } );
        Giftcard.hasMany( models.GyftrSlab, { foreignKey: 'giftcardId' } );
        Giftcard.hasOne( models.QcSlab, { foreignKey: 'giftcardId' } );
        Giftcard.hasOne( models.QcRange, { foreignKey: 'giftcardId' } );
        Giftcard.belongsToMany( models.User, { through: 'user_giftcards' } );

    };

    sequelizePaginate.paginate( Giftcard );
    return Giftcard;

};
