const { Sequelize: { Model } } = require( 'sequelize' );
const sequelizePaginate = require( 'sequelize-paginate' );
const { OnlineMerchant: OnlineMerchantSchema } = require( '../schema' );

class OnlineMerchant extends Model {}

module.exports = sequelize => {

    OnlineMerchant.init( OnlineMerchantSchema, { sequelize, tableName: 'online_merchants', underscored: true, timestamps: true } );
    OnlineMerchant.associate = models => {

        OnlineMerchant.hasMany( models.OnlineOffer, { foreignKey: 'merchantId' } );
        OnlineMerchant.hasMany( models.Giftcard, { foreignKey: 'merchantId' } );
        OnlineMerchant.belongsToMany( models.Tag, { through: 'online_merchant_tags' } );
        OnlineMerchant.belongsToMany( models.User, { through: 'user_online_merchants' } );

    };

    sequelizePaginate.paginate( OnlineMerchant );
    return OnlineMerchant;

};
