#! /bin/bash

NODE_MODULE_PATH=$(dirname $(dirname $0))
if [[ $(basename $NODE_MODULE_PATH) != "node_modules" ]]; then
    if [ -z $1 ] || [[ $1 != "--force" ]]; then
        echo "Error: if you want to run this script without npx, use the --force flag."
        exit 1
    fi
fi

if [[ $1 = "--force" ]]; then
    npx sequelize-cli db:seed:all
    exit $?
fi

BASE_PATH=$NODE_MODULE_PATH/@infino/data-models
CONFIG_PATH=$BASE_PATH/lib/config/sequelize-config.js
MIGRATIONS_PATH=$BASE_PATH/ancillary/migrations
SEED_PATH=$BASE_PATH/ancillary/seeds

npx sequelize-cli db:seed:all --config $CONFIG_PATH --migrations-path $MIGRATIONS_PATH --seeders-path $SEED_PATH
